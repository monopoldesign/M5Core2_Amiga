/******************************************************************************
* M5Core2_Amiga
* (C)2021 M.Volkel
*
* Frame: Settings
*******************************************************************************/

/******************************************************************************
* Header-Files
*******************************************************************************/
#include <M5Core2.h>

#include "main.h"
#include "frame_settings.h"

/******************************************************************************
* Global Variables
*******************************************************************************/

/******************************************************************************
* Functions
*******************************************************************************/

/*------------------------------------------------------------------------------
-
------------------------------------------------------------------------------*/
void but_changeVal(gui_args_vector_t &args)
{
	GUI_String *_but = NULL;

	_but = (GUI_String *)(args[0]);
	_but->setValue("Hallo");

	_but = (GUI_String *)(args[1]);
	_but->setValue(random(9999));
}

/*------------------------------------------------------------------------------
-
------------------------------------------------------------------------------*/
void but_exit(gui_args_vector_t &args)
{
	GUI_PopFrame();
	*((int *)(args[0])) = 0;
}

/*------------------------------------------------------------------------------
-
------------------------------------------------------------------------------*/
Frame_Settings::Frame_Settings(void)
{
	_frame_name = "Frame_Settings";

	// create String-Field and Number-Field
	_string[0] = new GUI_String("Text:", "Text", 320 - 200 - 16, (1 * (32 + 8)) + 48 + 16, 200, 24);
	_string[1] = new GUI_String("Number:", 1234, 320 - 200 - 16, (2 * (32 + 8)) + 48 + 16, 200, 24);

	// create Button
	_button[0] = new GUI_Button("Change Values", 16, (0 * (32 + 8)) + 48 + 16, 320 - (2 * 16), 32);
	_button[0]->AddArgs(EVENT_RELEASED, 0, _string[0]);
	_button[0]->AddArgs(EVENT_RELEASED, 1, _string[1]);
	_button[0]->Bind(EVENT_RELEASED, &but_changeVal);

	_button[1] = new GUI_Button("Exit", 16, (3 * (32 + 8)) + 48 + 16, 320 - (2 * 16), 32);
	_button[1]->AddArgs(EVENT_RELEASED, 0, (void *)(&_is_run));
	_button[1]->Bind(EVENT_RELEASED, &but_exit);
}

/*------------------------------------------------------------------------------
-
------------------------------------------------------------------------------*/
Frame_Settings::~Frame_Settings(void)
{
}

/*------------------------------------------------------------------------------
-
------------------------------------------------------------------------------*/
int Frame_Settings::init(gui_args_vector_t &args)
{
	_is_run = 1;

	// Window
	openWindow(0, 24, 320, 216, _frame_name);

	// Bevelbox
	bevel(8, 56, 320 - (2 * 8), 240 - (2 * 24) - (2 * 8), BT_RECESSED);

	for (uint8_t i = 0; i < 2; i++)
	{
		GUI_AddObject(_string[i]);
		_string[i]->init();

		GUI_AddObject(_button[i]);
		_button[i]->init();
	}

	return 3;
}
